<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lightning Alert Monitoring</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
/* --- PASTEL DARK COLOR VARIABLES --- */
:root {
Â  Â  --bg-dark: #111827; /* Dark Slate Gray */
Â  Â  --card-bg: #1f2937; /* Slightly Lighter Slate for card */
}
body {
Â  Â  font-family: 'Inter', sans-serif;
Â  Â  /* Softened radial gradient for a deep, muted look */
Â  Â  background: radial-gradient(circle at center, #1e293b 0%, var(--bg-dark) 100%);
Â  Â  min-height: 100vh;
}
.status-dot {
Â  Â  width: 1.25rem;
Â  Â  height: 1.25rem;
Â  Â  border-radius:50%;
Â  Â  transition: all 0.3s;
}
/* Pulsing animations use Tailwind colors, which look softer against the dark background */
.pulse-red {
Â  Â  animation: pulse-red 1.5s infinite;
}
@keyframes pulse-red {
Â  Â  /* Muted Red (Rose-600) */
Â  Â  0%{box-shadow:0 0 0 0 rgba(225, 29, 72, 1);}Â 
Â  Â  70%{box-shadow:0 0 0 15px rgba(225, 29, 72, 0);}
Â  Â  100%{box-shadow:0 0 0 0 rgba(225, 29, 72, 0);}
}
.pulse-green {
Â  Â  animation: pulse-green 1.5s infinite;
}
@keyframes pulse-green {
Â  Â  /* Muted Green (Emerald-500) */
Â  Â  0%{box-shadow:0 0 0 0 rgba(16, 185, 129, 1);}
Â  Â  70%{box-shadow:0 0 0 15px rgba(16, 185, 129, 0);}
Â  Â  100%{box-shadow:0 0 0 0 rgba(16, 185, 129, 0);}
}
/* Custom button style for a modern look */
.app-button {
Â  Â  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
Â  Â  transition: transform 0.15s, box-shadow 0.15s, background-color 0.15s;
Â  Â  border: 1px solid rgba(255, 255, 255, 0.1);
}
.app-button:hover:not(:disabled) {
Â  Â  transform: translateY(-2px);
Â  Â  box-shadow: 0 8px 10px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -4px rgba(0, 0, 0, 0.3);
}
.app-button:active:not(:disabled) {
Â  Â  transform: translateY(0);
}
.app-button:disabled {
Â  Â  cursor: not-allowed;
Â  Â  filter: brightness(0.7);
}
</style>
</head>

<body class="min-h-screen flex items-center justify-center text-white">

<div id="custom-alert-banner" class="fixed top-0 left-1/2 transform -translate-x-1/2 mt-4 p-3 rounded-lg shadow-xl text-center text-white font-bold transition-opacity duration-1000 opacity-0 z-50 pointer-events-none" style="min-width: 300px;">
</div>
<div class="bg-[var(--card-bg)] p-6 rounded-xl w-full max-w-md shadow-2xl border border-sky-700/50">
Â  Â Â 
Â  Â  <h1 class="text-2xl font-bold mb-4 text-emerald-300">âš¡ Lightning Alert Monitoring</h1>

Â  Â  <div class="mb-4 flex justify-between items-center bg-gray-700/40 p-3 rounded-lg border border-sky-500/30">
Â  Â  Â  Â  <span id="status-message" class="text-lg font-semibold"></span>
Â  Â  Â  Â  <div id="status-indicator" class="status-dot bg-gray-500"></div>
Â  Â  </div>
Â  Â Â 
Â  Â  <div class="space-y-1 mb-4">
Â  Â  Â  Â  <p class="text-sm bg-gray-700/40 p-2 rounded border border-gray-600/50">
Â  Â  Â  Â  Â  Â  Local Time:
Â  Â  Â  Â  Â  Â  <span id="current-time-display" class="text-emerald-300 font-medium">--:--:--</span>
Â  Â  Â  Â  </p>
Â  Â  Â  Â  <p class="text-sm bg-gray-700/40 p-2 rounded border border-gray-600/50">
Â  Â  Â  Â  Â  Â  Current Location:
Â  Â  Â  Â  Â  Â  <span id="current-location" class="text-emerald-300 font-medium">Our Tampines Hub</span>
Â  Â  Â  Â  </p>
Â  Â  </div>
Â  Â Â 
Â  Â  <p class="text-sm mb-4 bg-gray-700/40 p-2 rounded border border-gray-600/50">Notification Status:
Â  Â  Â  Â  <span id="current-permission" class="text-yellow-400 font-medium">Unknown</span>
Â  Â  </p>

Â  Â  <div class="space-y-3">
Â  Â  Â  Â  <button id="request-permission-btn" class="w-full bg-sky-700/80 p-3 rounded-lg font-semibold app-button hover:bg-sky-600 transition">
Â  Â  Â  Â  Â  Â  1. Request Notification Permission
Â  Â  Â  Â  </button>

Â  Â  Â  Â  <button id="start-monitor-btn" disabled class="w-full bg-teal-700/80 p-3 rounded-lg font-semibold app-button hover:bg-teal-600 transition">
Â  Â  Â  Â  Â  Â  2. Start Monitor
Â  Â  Â  Â  </button>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="flex space-x-3">
Â  Â  Â  Â  Â  Â  <button id="simulate-lightning-btn" disabled class="w-1/2 bg-rose-800/80 p-3 rounded-lg font-semibold app-button hover:bg-rose-700 transition">
Â  Â  Â  Â  Â  Â  Â  Â  3. Simulate Lightning (Siren)
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <button id="simulate-all-clear-btn" disabled class="w-1/2 bg-emerald-800/80 p-3 rounded-lg font-semibold app-button hover:bg-emerald-700 transition">
Â  Â  Â  Â  Â  Â  Â  Â  4. Simulate All Clear (Tone)
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <button id="stop-monitor-btn" disabled class="w-full bg-rose-700/80 p-3 rounded-lg font-semibold app-button hover:bg-rose-600 transition disabled:opacity-50 disabled:cursor-not-allowed">
Â  Â  Â  Â  Â  Â  Stop Monitor
Â  Â  Â  Â  </button>
Â  Â  </div>

Â  Â  <div id="quote-of-the-day" class="mt-4 p-3 rounded-lg bg-purple-900/40 text-sm italic text-gray-300 border border-purple-700/50">
Â  Â  Â  Â  <p class="font-bold text-purple-300 mb-1">Quote of the Day:</p>
Â  Â  Â  Â  <p id="daily-quote-text">Loading inspiration...</p>
Â  Â  </div>
</div>

<script>
const CHECK_INTERVAL_MS = 30000; // 30s
let monitorInterval = null;
let isAlertActive = false;Â 

// DOM Elements
const statusMessage = document.getElementById("status-message");
const statusIndicator = document.getElementById("status-indicator");
const startBtn = document.getElementById("start-monitor-btn");
const stopBtn = document.getElementById("stop-monitor-btn");
const simulateLightningBtn = document.getElementById("simulate-lightning-btn");
const simulateAllClearBtn = document.getElementById("simulate-all-clear-btn");
const requestBtn = document.getElementById("request-permission-btn");
const timeSpan = document.getElementById("current-time-display");
const permissionSpan = document.getElementById("current-permission");
const dailyQuoteText = document.getElementById("daily-quote-text");

// =========================================================
// DAILY QUOTE LOGIC
const INSPIRATIONAL_QUOTES = [
Â  Â  "The only way to do great work is to love what you do. â€“ Steve Jobs",
Â  Â  "Believe you can and you're halfway there. â€“ Theodore Roosevelt",
Â  Â  "The future belongs to those who believe in the beauty of their dreams. â€“ Eleanor Roosevelt",
Â  Â  "Strive not to be a success, but rather to be of value. â€“ Albert Einstein",
Â  Â  "The best time to plant a tree was 20 years ago. The second best time is now. â€“ Chinese Proverb",
Â  Â  "The difference between a successful person and others is not a lack of strength, not a lack of knowledge, but rather a lack of will. â€“ Vince Lombardi",
Â  Â  "Act as if what you do makes a difference. It does. â€“ William James",
Â  Â  "The mind is everything. What you think you become. â€“ Buddha",
Â  Â  "If you want to lift yourself up, lift up someone else. â€“ Booker T. Washington",
Â  Â  "Our greatest weakness lies in giving up. The most certain way to succeed is always to try just one more time. â€“ Thomas A. Edison"
];

function getDailyQuote() {
Â  Â  // Check for localStorage support
Â  Â  if (typeof(Storage) === "undefined") {
Â  Â  Â  Â  dailyQuoteText.textContent = "Error: Local storage not supported for daily quote.";
Â  Â  Â  Â  return;
Â  Â  }

Â  Â  const lastDateKey = 'lastQuoteDate';
Â  Â  const quoteKey = 'currentDailyQuote';
Â  Â Â 
Â  Â  // Get today's date string (e.g., "2025-12-03")
Â  Â  const today = new Date().toISOString().split('T')[0];
Â  Â Â 
Â  Â  const lastDate = localStorage.getItem(lastDateKey);
Â  Â  let quote = localStorage.getItem(quoteKey);

Â  Â  if (lastDate === today && quote) {
Â  Â  Â  Â  // It's the same day, use the stored quote
Â  Â  Â  Â  dailyQuoteText.textContent = quote;
Â  Â  Â  Â  console.log("Daily quote loaded from storage.");
Â  Â  } else {
Â  Â  Â  Â  // It's a new day or no quote stored, pick a new one
Â  Â  Â  Â  const randomIndex = Math.floor(Math.random() * INSPIRATIONAL_QUOTES.length);
Â  Â  Â  Â  const newQuote = INSPIRATIONAL_QUOTES[randomIndex];
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Store the new quote and today's date
Â  Â  Â  Â  localStorage.setItem(quoteKey, newQuote);
Â  Â  Â  Â  localStorage.setItem(lastDateKey, today);
Â  Â  Â  Â Â 
Â  Â  Â  Â  dailyQuoteText.textContent = newQuote;
Â  Â  Â  Â  console.log("New daily quote set and stored.");
Â  Â  }
}
// END DAILY QUOTE LOGIC
// =========================================================


// =========================================================
// Custom Banner Alert Function
// Default colors updated to muted teal/emerald
function showCustomBanner(message, bgColor = "#047857", borderColor = "#064e3b") {
Â  Â  const banner = document.getElementById("custom-alert-banner");
Â  Â  banner.innerHTML = message;Â 
Â  Â Â 
Â  Â  // Set dynamic styles
Â  Â  banner.style.backgroundColor = bgColor;
Â  Â  banner.style.borderColor = borderColor;

Â  Â  // Show the banner
Â  Â  banner.classList.remove("opacity-0");
Â  Â  banner.classList.add("opacity-100");

Â  Â  // Hide the banner after 4 seconds (4000ms)
Â  Â  setTimeout(() => {
Â  Â  Â  Â  banner.classList.remove("opacity-100");
Â  Â  Â  Â  banner.classList.add("opacity-0");
Â  Â  }, 4000);Â 
}

// =========================================================
// TIME DISPLAY & STATUS UI
function updateTime() {
Â  Â  const now = new Date();
Â  Â  timeSpan.textContent = now.toLocaleTimeString('en-US', {hour12:false});
}
updateTime();
setInterval(updateTime, 1000);

function updateStatus(text, color, pulse=false, symbol="") {
Â  Â  statusMessage.innerHTML = `<span class="mr-2 text-xl leading-none">${symbol}</span>${text}`;
Â  Â  statusIndicator.className = "status-dot";
Â  Â  statusIndicator.classList.add(color);
Â  Â  if(color.includes("red") && pulse) statusIndicator.classList.add("pulse-red");
Â  Â  if(color.includes("green") && pulse) statusIndicator.classList.add("pulse-green");
}

/* =========================================================
Â  Â  AUDIO ALERT FUNCTIONS (Persistent Nodes)
Â  Â  ========================================================= */

let audioContext = null;
let ringOscillator = null;
let ringGain = null;
let clearOscillator = null;
let clearGain = null;


function resumeAudioContext() {
Â  Â  if (audioContext && audioContext.state === 'suspended') {
Â  Â  Â  Â  audioContext.resume()
Â  Â  Â  Â  Â  Â  .then(() => console.log("AudioContext resumed successfully."))
Â  Â  Â  Â  Â  Â  .catch(e => console.error('Audio Resume Failed:', e));
Â  Â  }
}

function initAudioOnce() {
Â  Â  if (audioContext) return;

Â  Â  // Use webkitAudioContext for better compatibility on older iOS/Safari
Â  Â  audioContext = new (window.AudioContext || window.webkitAudioContext)();
Â  Â Â 
Â  Â  // 1. Siren Nodes Setup
Â  Â  ringOscillator = audioContext.createOscillator();
Â  Â  ringOscillator.frequency.value = 440;
Â  Â  ringOscillator.type = "sine";
Â  Â  ringGain = audioContext.createGain();
Â  Â  ringGain.gain.value = 0;Â 
Â  Â  ringOscillator.connect(ringGain);
Â  Â  ringGain.connect(audioContext.destination);
Â  Â  ringOscillator.start(0);Â 

Â  Â  // 2. All Clear Nodes Setup
Â  Â  clearOscillator = audioContext.createOscillator();
Â  Â  clearOscillator.frequency.value = 600;Â 
Â  Â  clearOscillator.type = 'sawtooth';Â 
Â  Â  clearGain = audioContext.createGain();
Â  Â  clearGain.gain.value = 0;
Â  Â  clearOscillator.connect(clearGain);
Â  Â  clearGain.connect(audioContext.destination);
Â  Â  clearOscillator.start(0);Â 
}

function stopSound() {
Â  Â  const now = audioContext.currentTime;
Â  Â Â 
Â  Â  if (ringGain) {
Â  Â  Â  Â  ringGain.gain.cancelScheduledValues(now);
Â  Â  Â  Â  ringGain.gain.setValueAtTime(0, now);
Â  Â  }
Â  Â Â 
Â  Â  if (clearGain) {
Â  Â  Â  Â  clearGain.gain.cancelScheduledValues(now);
Â  Â  Â  Â  clearGain.gain.setValueAtTime(0, now);
Â  Â  }
}

function playPhoneRing(durationMs = 3000) {Â 
Â  Â  initAudioOnce();Â 
Â  Â  resumeAudioContext();Â 
Â  Â Â 
Â  Â  if (!ringGain || audioContext.state !== 'running') return;

Â  Â  const now = audioContext.currentTime;
Â  Â Â 
Â  Â  if (clearGain) {
Â  Â  Â  Â  clearGain.gain.cancelScheduledValues(now);
Â  Â  Â  Â  clearGain.gain.setValueAtTime(0, now);
Â  Â  }

Â  Â  ringGain.gain.cancelScheduledValues(now);
Â  Â  ringGain.gain.setValueAtTime(0, now);Â 
Â  Â Â 
Â  Â  let t = now;
Â  Â  const end = t + durationMs / 1000;
Â  Â  const ringInterval = 0.4;Â 

Â  Â  while (t < end) {
Â  Â  Â  Â  ringGain.gain.setValueAtTime(0.5, t);
Â  Â  Â  Â  t += ringInterval / 2;
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (t < end) {
Â  Â  Â  Â  Â  Â  ringGain.gain.setValueAtTime(0, t);
Â  Â  Â  Â  Â  Â  t += ringInterval / 2;
Â  Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  ringGain.gain.setValueAtTime(0, end);
}

function playAllClearTone(durationSec = 3) {
Â  Â  initAudioOnce();
Â  Â  resumeAudioContext();Â 
Â  Â Â 
Â  Â  if (!clearGain || audioContext.state !== 'running') return;
Â  Â Â 
Â  Â  const now = audioContext.currentTime;
Â  Â Â 
Â  Â  if (ringGain) {
Â  Â  Â  Â  ringGain.gain.cancelScheduledValues(now);
Â  Â  Â  Â  ringGain.gain.setValueAtTime(0, now);
Â  Â  }
Â  Â Â 
Â  Â  clearGain.gain.cancelScheduledValues(now);
Â  Â  clearGain.gain.setValueAtTime(0, now);
Â  Â Â 
Â  Â  const end = now + durationSec;
Â  Â Â 
Â  Â  clearGain.gain.linearRampToValueAtTime(0.4, now + 0.1);Â 
Â  Â  clearGain.gain.linearRampToValueAtTime(0.0001, end);Â 
}


// =========================================================
// ALERT CONTROL FUNCTIONS

function triggerAlert(forecast="Thunderstorm detected") {
Â  Â  isAlertActive = true;Â 
Â  Â  playPhoneRing();Â 
Â  Â  updateStatus("LIGHTNING ALERT", "bg-red-600", true, "ðŸš¨â›ˆï¸"); // Uses bg-red-600, which pulses with muted red

Â  Â  // Custom message for Lightning Alert (Muted Rose/Burgundy)
Â  Â  showCustomBanner("ðŸš¨ LIGHTNING ALERT NOW. TURN ON BLINKER & POST MESSAGE TO SPORTS GROUP", "#a12c4b", "#881337");Â 

Â  Â  if(Notification.permission === "granted") {
Â  Â  Â  Â  new Notification("Lightning Alert", {
Â  Â  Â  Â  Â  Â  body: forecast,
Â  Â  Â  Â  Â  Â  // Muted red icon color
Â  Â  Â  Â  Â  Â  icon: "https://placehold.co/64x64/a12c4b/ffffff?text=âš¡ï¸"
Â  Â  Â  Â  });
Â  Â  }
}

function clearAlert() {
Â  Â  stopSound();Â 
Â  Â  isAlertActive = false;Â 

Â  Â  playAllClearTone();Â 

Â  Â  // Green box message for All Clear (Muted Emerald/Teal)
Â  Â  showCustomBanner("All Clear! Situation safe. Monitoring continues. ðŸŽ‰", "#047857", "#064e3b");

Â  Â  updateStatus("ALL CLEAR: Situation Safe", "bg-yellow-500", false, "ðŸ””âœ¨");

Â  Â  if(Notification.permission === "granted") {
Â  Â  Â  Â  new Notification("Lightning Alert Cleared", {
Â  Â  Â  Â  Â  Â  body: "The area is now safe. Monitoring is continuing.",
Â  Â  Â  Â  Â  Â  // Muted yellow icon color
Â  Â  Â  Â  Â  Â  icon: "https://placehold.co/64x64/f59e0b/000000?text=ðŸ””"
Â  Â  Â  Â  });
Â  Â  }
}


// =========================================================
// FETCH WEATHER FORECAST
const API_URL = "https://api.data.gov.sg/v1/environment/2-hour-weather-forecast";
const TARGET_AREA = "Tampines";

async function checkForecast() {
Â  Â  try {
Â  Â  Â  Â  const res = await fetch(API_URL);
Â  Â  Â  Â  const data = await res.json();
Â  Â  Â  Â  const forecastItem = data.items[0];
Â  Â  Â  Â  const areaForecast = forecastItem.forecasts.find(f => f.area.toUpperCase() === TARGET_AREA.toUpperCase());
Â  Â  Â  Â  const forecastText = areaForecast ? areaForecast.forecast : "Data unavailable";

Â  Â  Â  Â  const alertKeywords = ["Thunder", "TShowers"];
Â  Â  Â  Â  const isAlert = alertKeywords.some(k => forecastText.toLowerCase().includes(k.toLowerCase()));

Â  Â  Â  Â  if(isAlert){
Â  Â  Â  Â  Â  Â  if (!isAlertActive) {
Â  Â  Â  Â  Â  Â  Â  Â  triggerAlert(`Forecast: ${forecastText}`);
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  updateStatus("LIGHTNING ALERT", "bg-red-600", true, "ðŸš¨â›ˆï¸");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  if (isAlertActive) {
Â  Â  Â  Â  Â  Â  Â  Â  clearAlert();
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  updateStatus(`Safe: ${forecastText}`, "bg-green-500", true, "âœ…â˜€ï¸");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  } catch(err) {
Â  Â  Â  Â  updateStatus("Error fetching forecast", "bg-yellow-500", false, "âš ï¸");
Â  Â  Â  Â  console.error(err);
Â  Â  }
}

// =========================================================
// MONITOR CONTROLÂ 
function startMonitor() {
Â  Â  initAudioOnce();Â 
Â  Â  resumeAudioContext();Â 
Â  Â  updateStatus("Monitoring...", "bg-blue-500", false, "ðŸ”");
Â  Â  checkForecast();Â 
Â  Â  if (monitorInterval) clearInterval(monitorInterval);
Â  Â  monitorInterval = setInterval(checkForecast, CHECK_INTERVAL_MS);
Â  Â  startBtn.disabled = true;
Â  Â  stopBtn.disabled = false;
Â  Â  // Disable both simulation buttons while monitoring
Â  Â  simulateLightningBtn.disabled = true;
Â  Â  simulateAllClearBtn.disabled = true;
}

function stopMonitor() {
Â  Â  clearInterval(monitorInterval);
Â  Â  monitorInterval = null;
Â  Â  stopSound();
Â  Â  isAlertActive = false;
Â  Â  updateStatus("Stopped", "bg-gray-500", false, "ðŸ›‘");
Â  Â  startBtn.disabled = false;
Â  Â  stopBtn.disabled = true;
Â  Â  // Enable both simulation buttons when monitoring stops
Â  Â  simulateLightningBtn.disabled = false;
Â  Â  simulateAllClearBtn.disabled = false;
}

// =========================================================
// PERMISSION FLOWÂ 
function requestPermission() {
Â  Â  if(!("Notification" in window)){
Â  Â  Â  Â  console.error("This browser does not support notifications.");
Â  Â  Â  Â  permissionSpan.textContent = "Unsupported";
Â  Â  Â  Â  permissionSpan.className = "text-red-400 font-medium";
Â  Â  Â  Â  requestBtn.disabled = true;
Â  Â  Â  Â  requestBtn.textContent = "Notifications Unsupported";
Â  Â  Â  Â  return;
Â  Â  }
Â  Â Â 
Â  Â  requestBtn.disabled = true;Â 
Â  Â  requestBtn.textContent = "Requesting...";Â 

Â  Â  Notification.requestPermission().then(permission => {
Â  Â  Â  Â  permissionSpan.textContent = permission.charAt(0).toUpperCase() + permission.slice(1);
Â  Â  Â  Â  if(permission === "granted"){
Â  Â  Â  Â  Â  Â  permissionSpan.className = "text-green-400 font-medium";
Â  Â  Â  Â  Â  Â  startBtn.disabled = false;
Â  Â  Â  Â  Â  Â  // Enable simulation buttons
Â  Â  Â  Â  Â  Â  simulateLightningBtn.disabled = false;
Â  Â  Â  Â  Â  Â  simulateAllClearBtn.disabled = false;
Â  Â  Â  Â  Â  Â  requestBtn.textContent = "Permission Granted";Â 
Â  Â  Â  Â  } else if(permission === "denied"){
Â  Â  Â  Â  Â  Â  permissionSpan.className = "text-red-400 font-medium";
Â  Â  Â  Â  Â  Â  requestBtn.textContent = "Permission Denied";Â 
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  permissionSpan.className = "text-yellow-400 font-medium";
Â  Â  Â  Â  Â  Â  requestBtn.textContent = "Prompt Ignored/Default";Â 
Â  Â  Â  Â  }
Â  Â  });
}

// =========================================================
// EVENT LISTENERS & INITIALIZATION
requestBtn.addEventListener("click", requestPermission);
startBtn.addEventListener("click", startMonitor);
stopBtn.addEventListener("click", stopMonitor);

// NEW DEDICATED SIMULATION LISTENERS
simulateLightningBtn.addEventListener("click", () => {
Â  Â  initAudioOnce();Â 
Â  Â  resumeAudioContext();
Â  Â  triggerAlert("Simulated Lightning Alert"); // Start the alert state
});

simulateAllClearBtn.addEventListener("click", () => {
Â  Â  initAudioOnce();Â 
Â  Â  resumeAudioContext();
Â  Â  clearAlert(); // End the alert state
});


window.onload = () => {
Â  Â  // Initial check for notification status
Â  Â  if ("Notification" in window) {
Â  Â  Â  Â  const permission = Notification.permission;
Â  Â  Â  Â Â 
Â  Â  Â  Â  permissionSpan.textContent = permission.charAt(0).toUpperCase() + permission.slice(1);

Â  Â  Â  Â  if (permission === "granted") {
Â  Â  Â  Â  Â  Â  permissionSpan.className = "text-green-400 font-medium";
Â  Â  Â  Â  Â  Â  startBtn.disabled = false;
Â  Â  Â  Â  Â  Â  // Enable simulation buttons
Â  Â  Â  Â  Â  Â  simulateLightningBtn.disabled = false;
Â  Â  Â  Â  Â  Â  simulateAllClearBtn.disabled = false;
Â  Â  Â  Â  Â  Â  requestBtn.disabled = true;
Â  Â  Â  Â  Â  Â  requestBtn.textContent = "Permission Granted";
Â  Â  Â  Â  } else if (permission === "denied") {
Â  Â  Â  Â  Â  Â  permissionSpan.className = "text-red-400 font-medium";
Â  Â  Â  Â  Â  Â  requestBtn.disabled = true;
Â  Â  Â  Â  Â  Â  requestBtn.textContent = "Permission Denied";
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  permissionSpan.className = "text-yellow-400 font-medium";
Â  Â  Â  Â  Â  Â  startBtn.disabled = true;
Â  Â  Â  Â  Â  Â  // Disable simulation buttons
Â  Â  Â  Â  Â  Â  simulateLightningBtn.disabled = true;
Â  Â  Â  Â  Â  Â  simulateAllClearBtn.disabled = true;
Â  Â  Â  Â  }
Â  Â  } else {
Â  Â  Â  Â  permissionSpan.textContent = "Unsupported";
Â  Â  Â  Â  permissionSpan.className = "text-red-400 font-medium";
Â  Â  Â  Â  requestBtn.disabled = true;
Â  Â  Â  Â  requestBtn.textContent = "Notifications Unsupported";
Â  Â  }

Â  Â  updateStatus("Awaiting Start", "bg-gray-500", false, "âšª");

Â  Â  initAudioOnce();
Â  Â Â 
Â  Â  // Get and display the daily quote
Â  Â  getDailyQuote(); 
};
</script>
</body>
</html>
